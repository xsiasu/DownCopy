{% comment %}
  {%- capture flickity_options -%}
  {

  }
  {%- endcapture -%}
{% endcomment %}

<section id="section-{{section.id}}">
  <div class="main-carousel">
    {% for block in section.blocks %}
      <div id="Slide{{block.id}}" class="carousel-cell">
        {% if block.settings.mobile_image %}
          <div
            class="AspectRatio Slideshow__ImageContainer mobile-{{block.settings.mobile_image.id}} mobile-image"
            style="--aspect-ratio: {{ block.settings.mobile_image.aspect_ratio }}; background-image: url({{ block.settings.mobile_image | img_url: '1x1', format: 'jpg' }})"
          >
            {{ block.settings.mobile_image | image_url: width: 3840 | image_tag: loading: 'lazy' }}
            <noscript>
              <img
                class="Slideshow__Image"
                src="{{ block.settings.mobile_image | img_url: 'x800' }}"
                alt="{{ block.settings.mobile_image.alt | escape }}"
              >
            </noscript>
          </div>
        {% endif %}

        {%- if block.settings.image -%}
          <div
            class="AspectRatio Slideshow__ImageContainer desktop-{{block.settings.image.id}} desktop-image"
            style="--aspect-ratio: {{ block.settings.image.aspect_ratio }}; background-image: url({{ block.settings.image | img_url: '1x1', format: 'jpg' }})"
          >
            {{ block.settings.image | image_url: width: 3840 | image_tag: loading: 'lazy' }}

            <noscript>
              <img
                class="Slideshow__Image"
                src="{{ block.settings.image | img_url: '1000x' }}"
                alt="{{ block.settings.image.alt | escape }}"
              >
            </noscript>
          </div>
        {% else %}
          <div class="Slideshow__ImageContainer">
            {% capture placeholder %}{%cycle 'lifestyle-1'%}{% endcapture %}
            {{ placeholder | placeholder_svg_tag: 'Slideshow__Image PlaceholderBackground__Svg' }}
          </div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</section>

<style>
       * {
         box-sizing: border-box;
       }

       .carousel {
         background: #eee;
       }
       @media screen and (min-width: 990px) {
        .carousel-cell {
          width: 30%;
          background: #8c8;
          border-radius: 5px;
          counter-increment: carousel-cell;
          border-radius:10px;
          margin-right:40px;
          overflow:hidden;
          background:#efefef
        }
      }

      @media screen and (max-width: 990px) {
       .carousel-cell {
        width: 66%;
        background: #8C8;
        border-radius: 5px;
        counter-increment: gallery-cell;
        background:red;
         margin-right:30px;
      }
    }
       .carousel-cell.is-selected {
         background: #ed2;
       }

       /* cell number */
  {% comment %} .carousel-cell:before {
         display: block;
         text-align: center;
         content: counter(carousel-cell);
         line-height: 200px;
         font-size: 80px;
         color: white;
       } {% endcomment %}

       .Slideshow__ImageContainer {
         height: 100%;
       }
       .mobile-image {
         display: block;
       }
       .desktop-image {
         display: none;
       }
       {% comment %} .carousel-cell {
         display: block;
         width: 100%;
       } {% endcomment %}

       /**
      * ----------------------------------------------------------------------------
      * Aspect ratio
      * ----------------------------------------------------------------------------
      */

       .AspectRatio {
         position: relative;
         margin-left: auto;
         margin-right: auto;
       }

       .AspectRatio::before {
         content: '';
         display: block;
       }

       .AspectRatio img {
         max-height: 100%;
         max-width: 100%;
       }

       .AspectRatio--withFallback img {
         position: absolute;
         top: 0;
         left: 0;
         height: 100%;
         width: 100%;
       }

       .no-js .AspectRatio img {
         display: none !important;
       }

       @supports (--css: variables) {
         /* For dynamic one, we use CSS variables, which makes it only compatible for newer browsers */

         .AspectRatio--withFallback {
           padding-bottom: 0 !important; /* For older browsers we use the padding-bottom trick, so make sure to remove it here */
         }

         .AspectRatio::before {
           padding-bottom: calc(100% / (var(--aspect-ratio)));
         }

         .AspectRatio img,
         .no-js .AspectRatio noscript img {
           position: absolute;
           top: 0;
           left: 0;
           height: 100%;
           width: 100%;
         }
       }

       .AspectRatio--square::before {
         padding-bottom: 100%;
       }

       .AspectRatio--short::before {
         padding-bottom: 75%;
       }

       .AspectRatio--tall::before {
         padding-bottom: 150%;
       }

       .AspectRatio--square img,
       .AspectRatio--short img,
       .AspectRatio--tall img {
         position: absolute;
         width: auto;
         height: auto;
         left: 50%;
         top: 50%;
         -webkit-transform: translate(-50%, -50%);
         transform: translate(-50%, -50%);
         -webkit-backface-visibility: hidden;
         backface-visibility: hidden;
       }
       .Image--lazyLoad[data-sizes='auto'] {
         width: 100%; /* this is needed to help LazySizes calculate the correct size */
       }
       /**
        * ----------------------------------------------------------------------------
        * List
        * ----------------------------------------------------------------------------
        */

       @media (min-width: 992px) {
         .mobile-image {
           display: none;
         }
         .desktop-image {
           display: block;
         }
       }
</style>

<script>
  var elem = document.querySelector('.main-carousel');
  var flkty = new Flickity(elem,{
    "prevNextButtons": true,
    {% comment %} "setGallerySize": {% if section.settings.show_fullscreen %}false{% else %}true{% endif %},
    "adaptiveHeight": {% if section.settings.show_fullscreen %}false{% else %}true{% endif %}, {% endcomment %}
    {% comment %} "wrapAround": true, {% endcomment %}
    "dragThreshold": 15,
    "pauseAutoPlayOnHover": false,
    "autoPlay": {% if section.settings.autoplay %}{{ section.settings.cycle_speed | times: 1000 }}{% else %}false{% endif %},
    "pageDots": {% if section.blocks.size > 1 %}true{% else %}false{% endif %},
    {% comment %} "freeScroll": true, {% endcomment %}
    {% comment %} "initialIndex": 2, {% endcomment %}
    "wrapAround": true
  });
</script>

{% schema %}
{
  "name": "Slideshow-kim",
  "class": "shopify-section--slideshow",
  "max_blocks": 5,
  "settings": [
    {
      "type": "checkbox",
      "id": "show_fullscreen",
      "label": "Show full-screen images",
      "info": "If enabled, images will be resized to fit the entire screen.",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_arrow",
      "label": "Show bottom arrow",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Auto rotate between slides",
      "default": true
    },
    {
      "type": "range",
      "id": "cycle_speed",
      "min": 3,
      "max": 8,
      "step": 1,
      "unit": "sec",
      "label": "Change slides every",
      "default": 5
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button text",
      "default": "#363636"
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image",
          "info": "1560 x 1050px jpg recommended"
        },
        {
          "type": "image_picker",
          "id": "mobile_image",
          "label": "Mobile image",
          "info": "750 x 1100px jpg recommended. If none is set, desktop image will be cropped."
        },
        {
          "type": "checkbox",
          "id": "apply_overlay",
          "label": "Apply overlay on image",
          "info": "This can improve text visibility.",
          "default": true
        },
        {
          "type": "select",
          "id": "content_position",
          "label": "Desktop content position",
          "options": [
            {
              "value": "middleLeft",
              "label": "Middle left"
            },
            {
              "value": "middleCenter",
              "label": "Middle center"
            },
            {
              "value": "bottomLeft",
              "label": "Bottom left"
            },
            {
              "value": "bottomCenter",
              "label": "Bottom center"
            }
          ],
          "default": "bottomLeft"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Sub-heading",
          "default": "Slide title"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Tell your story"
        },
        {
          "type": "header",
          "content": "Button 1"
        },
        {
          "type": "text",
          "id": "button_1_text",
          "label": "Text"
        },
        {
          "type": "url",
          "id": "button_1_link",
          "label": "Link"
        },
        {
          "type": "header",
          "content": "Button 2"
        },
        {
          "type": "text",
          "id": "button_2_text",
          "label": "Text"
        },
        {
          "type": "url",
          "id": "button_2_link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "category": "Image",
      "name": "Slideshow-kim",
      "settings": {},
      "blocks": [
        {
          "type": "image"
        },
        {
          "type": "image"
        }
      ]
    }
  ]
}
{% endschema %}
